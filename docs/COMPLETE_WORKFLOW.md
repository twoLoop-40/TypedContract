# ì™„ì „í•œ ë¬¸ì„œ ìƒì„± ì›Œí¬í”Œë¡œìš° (ê°œì •íŒ)

## ê°œìš”

ì‚¬ìš©ìì™€ì˜ **ë°˜ë³µì  ìƒí˜¸ì‘ìš©**ì„ í†µí•´ ì ì§„ì ìœ¼ë¡œ ë¬¸ì„œë¥¼ ì™„ì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 1: ëª…ì„¸ ìƒì„± (ìë™)                                  â”‚
â”‚  ìë£Œ + í”„ë¡¬í”„íŠ¸ â†’ Idris2 ëª…ì„¸ â†’ ì»´íŒŒì¼ ë£¨í”„                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 2: ì´ˆì•ˆ ìƒì„± (ìë™)                                  â”‚
â”‚  ëª…ì„¸ â†’ ë¬¸ì„œ êµ¬í˜„ í•¨ìˆ˜ â†’ ê²½ëŸ‰ ì¶œë ¥ (txt/csv)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 3: ë°˜ë³µ ê°œì„  (ì‚¬ìš©ì ì£¼ë„)                           â”‚
â”‚  ì´ˆì•ˆ ê²€í†  â†’ ë³´ê°•ì‚¬í•­ â†’ ëª…ì„¸ ìˆ˜ì • â†’ ì¬ìƒì„± â†’ ê²€í†  â†’ ...    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Phase 4: ìµœì¢… ì¶œë ¥ (ì„ íƒ)                                  â”‚
â”‚  ë§Œì¡± â†’ PDF ìƒì„± â†’ ì™„ë£Œ                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì „ì²´ ì›Œí¬í”Œë¡œìš°

### 1ï¸âƒ£ ìë£Œ ì—…ë¡œë“œ + í”„ë¡¬í”„íŠ¸

**ì…ë ¥**:
- ì°¸ê³  ë¬¸ì„œ (PDF, DOC, ì´ë¯¸ì§€)
- ì‚¬ìš©ì í”„ë¡¬í”„íŠ¸
  ```
  "ìŠ¤í”¼ë¼í‹°ì™€ ì´ì¸ ì—ë“€ ê°„ ìˆ˜í•™ë¬¸í•­ ì…ë ¥ ìš©ì—­ê³„ì•½ì„œë¥¼ ë§Œë“¤ì–´ì¤˜.
   ì´ 50,650ë¬¸í•­, ë‹¨ê°€ 1,000ì›, ê¸°ê°„ì€ 10ì›” 1ì¼ë¶€í„° 11ì›” 30ì¼ê¹Œì§€.
   ì‚°ì¶œë¬¼ì€ 3ì°¨ë¡œ ë‚˜ëˆ ì„œ ë‚©í’ˆ."
  ```

**ì¶œë ¥**:
- `input/` í´ë”ì— ì €ì¥
- í”„ë¡¬í”„íŠ¸ íŒŒì‹±

---

### 2ï¸âƒ£ Idris2 ëª…ì„¸ ìƒì„± (ìë™)

**ì—ì´ì „íŠ¸ ì‘ì—…**:

#### Step 2.1: ë¬¸ì„œ ë¶„ì„
- ì°¸ê³  ë¬¸ì„œ ì½ê¸°
- í”„ë¡¬í”„íŠ¸ì—ì„œ ìš”êµ¬ì‚¬í•­ ì¶”ì¶œ
- êµ¬ì¡°í™”ëœ ë¶„ì„ ìƒì„±

```markdown
# ë¶„ì„ ê²°ê³¼

## ìš”êµ¬ì‚¬í•­
- ê³„ì•½ ë‹¹ì‚¬ì: ìŠ¤í”¼ë¼í‹°, ì´ì¸ ì—ë“€
- í’ˆëª©: ìˆ˜í•™ë¬¸í•­ ì…ë ¥ (50,650ë¬¸í•­)
- ë‹¨ê°€: 1,000ì›/ë¬¸í•­
- ì´ì•¡: 50,650,000ì› + VAT
- ê¸°ê°„: 2025-10-01 ~ 2025-11-30
- ì‚°ì¶œë¬¼: 3ì°¨ ë‚©í’ˆ

## ë¶ˆë³€ì‹
- ì´ì•¡ = ë‹¨ê°€ Ã— ìˆ˜ëŸ‰
- VAT = ê³µê¸‰ê°€ì•¡ Ã— 0.10
```

#### Step 2.2: Idris2 ëª…ì„¸ ìƒì„±
```idris
module Domains.SpiratiContract

data UnitPrice : Type where
  MkUnitPrice : (perItem : Nat)
    -> (quantity : Nat)
    -> (total : Nat)
    -> (total = perItem * quantity)
    -> UnitPrice

-- ... ì „ì²´ ëª…ì„¸
```

#### Step 2.3: ì»´íŒŒì¼ & ìˆ˜ì • ë£¨í”„ (ìë™)
```
[Attempt 1] idris2 --check â†’ âŒ Error
[Attempt 2] Fix error â†’ idris2 --check â†’ âŒ Error
[Attempt 3] Fix error â†’ idris2 --check â†’ âœ… Success
```

**ì¶œë ¥**:
- `Domains/SpiratiContract.idr` (íƒ€ì… ì²´í¬ ì™„ë£Œ)
- `direction/analysis_SpiratiContract.md`

---

### 3ï¸âƒ£ ë¬¸ì„œ êµ¬í˜„ í•¨ìˆ˜ ì™„ì„± (ìë™)

**ì—ì´ì „íŠ¸ ì‘ì—…**:

#### Step 3.1: Documentable ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
```idris
-- Core/DomainToDoc.idrì— ì¶”ê°€
Documentable ServiceContract where
  toDocument sc = MkDoc
    (MkMetadata "ìš©ì—­ê³„ì•½ì„œ" ...)
    [ Heading 1 "ìš©ì—­ê³„ì•½ì„œ"
    , Para ("ê³„ì•½ë²ˆí˜¸: " ++ sc.contractNumber)
    , ...
    ]
```

#### Step 3.2: íŒŒì´í”„ë¼ì¸ ìƒì„±
```idris
-- Core/Generator.idrì— ì¶”ê°€
spiratiPipeline : GenerationPipeline ServiceContract
spiratiPipeline = createPipeline spiratiContract "output/contract"
```

**ì¶œë ¥**:
- `Core/DomainToDoc.idr` (ì—…ë°ì´íŠ¸)
- `Core/Generator.idr` (ì—…ë°ì´íŠ¸)

---

### 4ï¸âƒ£ ì´ˆì•ˆ ìƒì„± (ê²½ëŸ‰ ì¶œë ¥)

**ì¤‘ìš”**: PDF ë°”ë¡œ ìƒì„± âŒ, ë¨¼ì € ê°€ë²¼ìš´ í˜•ì‹ìœ¼ë¡œ ë³´ì—¬ì£¼ê¸°!

#### Step 4.1: í…ìŠ¤íŠ¸ ì¶œë ¥
```bash
idris2 --exec generateText Main.idr
```

**ìƒì„±**:
```
output/contract_draft.txt
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ìš©ì—­ê³„ì•½ì„œ

ê³„ì•½ë²ˆí˜¸: SPRT-2025-001
ê³„ì•½ì¼ì: 2025ë…„ 10ì›” 1ì¼

ì£¼ì‹íšŒì‚¬ ìŠ¤í”¼ë¼í‹°(ì´í•˜ "ê°‘"ì´ë¼ í•œë‹¤)ì™€
ì£¼ì‹íšŒì‚¬ ì´ì¸ ì—ë“€(ì´í•˜ "ì„"ì´ë¼ í•œë‹¤)ëŠ”
...

ì œ1ì¡° (ê³„ì•½ì˜ ëª©ì )
ë³¸ ê³„ì•½ì€ ...

...
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

#### Step 4.2: CSV/Excel ì¶œë ¥ (í‘œ í˜•ì‹ ë°ì´í„°)
```csv
# payment_schedule.csv
í•­ëª©,ê¸ˆì•¡,ì¼ì
ì„ ê¸‰ê¸ˆ,20000000,ê³„ì•½ í›„ 7ì¼
ì¤‘ë„ê¸ˆ,15000000,2025-11-20
ì”ê¸ˆ,20715000,2025-11-30
```

#### Step 4.3: Markdown ì¶œë ¥
```markdown
# contract_draft.md

## ìš©ì—­ê³„ì•½ì„œ

**ê³„ì•½ë²ˆí˜¸**: SPRT-2025-001
...
```

**ì¶œë ¥**:
- `output/contract_draft.txt`
- `output/payment_schedule.csv`
- `output/contract_draft.md`

**ì‚¬ìš©ìì—ê²Œ ì œì‹œ**:
```
âœ… ì´ˆì•ˆì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!

ë‹¤ìŒ íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”:
- output/contract_draft.txt (ì „ì²´ ë‚´ìš©)
- output/payment_schedule.csv (ì§€ê¸‰ ì¼ì •)

ë§Œì¡±í•˜ì‹œë©´ "ì™„ë£Œ", ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ìš”ì²­ì‚¬í•­ì„ ë§ì”€í•´ì£¼ì„¸ìš”.
```

---

### 5ï¸âƒ£ ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘

**ì‚¬ìš©ì ì…ë ¥**:
```
"ì„ ê¸‰ê¸ˆ ë¹„ìœ¨ì„ 30%ë¡œ ì˜¬ë ¤ì£¼ê³ ,
ì¤‘ë„ê¸ˆ ì¼ìë¥¼ 11ì›” 15ì¼ë¡œ ì•ë‹¹ê²¨ì¤˜.
ê·¸ë¦¬ê³  ì œ14ì¡°ì— 'ì£¼ì°¨ë³„ ì§„í–‰ë³´ê³ ' ì¡°í•­ ì¶”ê°€í•´ì¤˜."
```

**íŒŒì‹± ê²°ê³¼**:
```json
{
  "changes": [
    {
      "field": "payment.advance",
      "value": "30%",
      "old_value": "20,000,000ì›"
    },
    {
      "field": "payment.interim_date",
      "value": "2025-11-15",
      "old_value": "2025-11-20"
    },
    {
      "field": "terms.special_provisions",
      "action": "add",
      "value": "ì£¼ì°¨ë³„ ì§„í–‰ë³´ê³  ì˜ë¬´"
    }
  ]
}
```

---

### 6ï¸âƒ£ ëª…ì„¸ ìˆ˜ì • â†’ ì¬ìƒì„± ë£¨í”„

**ì—ì´ì „íŠ¸ ì‘ì—…**:

#### Step 6.1: ëª…ì„¸ ìˆ˜ì •
```idris
-- Domains/SpiratiContract.idr ìë™ ìˆ˜ì •

-- Before:
paymentSchedule = [20000000, 15000000, 20715000]

-- After:
paymentSchedule = [33000000, 15000000, 7715000]  -- 30% ì„ ê¸‰ê¸ˆ
```

#### Step 6.2: ì¬ì»´íŒŒì¼
```bash
idris2 --check Domains/SpiratiContract.idr
# âœ… Success (ê¸ˆì•¡ í•©ê³„ ì¦ëª…ë„ ìë™ ì¬ê³„ì‚°)
```

#### Step 6.3: ë¬¸ì„œ ì¬ìƒì„±
```bash
idris2 --exec generateText Main.idr
```

**ì¶œë ¥**:
```
output/contract_draft_v2.txt
output/contract_draft_v2.md
```

**ì‚¬ìš©ìì—ê²Œ ì œì‹œ**:
```
âœ… ìˆ˜ì • ì™„ë£Œ!

ë³€ê²½ì‚¬í•­:
- ì„ ê¸‰ê¸ˆ: 20,000,000ì› â†’ 33,000,000ì› (30%)
- ì¤‘ë„ê¸ˆ ì¼ì: 2025-11-20 â†’ 2025-11-15
- ì œ14ì¡° 4í•­ ì¶”ê°€: ì£¼ì°¨ë³„ ì§„í–‰ë³´ê³  ì˜ë¬´

output/contract_draft_v2.txtë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.
ì¶”ê°€ ìˆ˜ì •ì´ í•„ìš”í•˜ë©´ ë§ì”€í•´ì£¼ì„¸ìš”.
```

---

### 7ï¸âƒ£ ë°˜ë³µ (ì‚¬ìš©ìê°€ ë§Œì¡±í•  ë•Œê¹Œì§€)

```
ì‚¬ìš©ì: "ì¢‹ì•„, ì´ì œ ì™„ë£Œ!"
```

ë˜ëŠ”

```
ì‚¬ìš©ì: "ì œ8ì¡° ì§€ì ì¬ì‚°ê¶Œ ë¶€ë¶„ì„ ë” ëª…í™•í•˜ê²Œ í•´ì¤˜..."
â†’ ë‹¤ì‹œ 6ë‹¨ê³„ë¡œ
```

---

### 8ï¸âƒ£ PDF ìƒì„± (ìµœì¢…)

**ì‚¬ìš©ì**:
```
"ì™„ë£Œ! ì´ì œ PDFë¡œ ë§Œë“¤ì–´ì¤˜."
```

**ì—ì´ì „íŠ¸**:
```bash
idris2 --exec main Main.idr
# LaTeX ìƒì„± â†’ pdflatex ì‹¤í–‰
```

**ì¶œë ¥**:
```
output/contract_final.pdf âœ…
```

---

### 9ï¸âƒ£ ë§ˆë¬´ë¦¬

**ìµœì¢… ì‚°ì¶œë¬¼**:
```
output/
â”œâ”€â”€ contract_draft.txt        # ì´ˆì•ˆ (í…ìŠ¤íŠ¸)
â”œâ”€â”€ contract_draft_v2.txt     # ìˆ˜ì •ë³¸
â”œâ”€â”€ payment_schedule.csv      # ì§€ê¸‰ ì¼ì • (CSV)
â”œâ”€â”€ contract_draft.md         # ë§ˆí¬ë‹¤ìš´
â””â”€â”€ contract_final.pdf        # ìµœì¢… PDF

Domains/
â””â”€â”€ SpiratiContract.idr       # Idris2 ëª…ì„¸ (ê²€ì¦ ì™„ë£Œ)

direction/
â””â”€â”€ analysis_SpiratiContract.md  # ë¶„ì„ ê²°ê³¼
```

**ë²„ì „ ê´€ë¦¬**:
```bash
git add -A
git commit -m "Complete: Spirati-ItsEdu contract (v2 - 30% advance)"
```

---

## LangGraph State (ê°œì •íŒ)

```python
class DocumentGenerationState(TypedDict):
    # ========== Phase 1: ì…ë ¥ ==========
    project_name: str
    user_prompt: str
    reference_docs: List[str]

    # ========== Phase 2: ëª…ì„¸ ìƒì„± ==========
    analysis: Optional[str]
    idris_spec: Optional[str]  # Idris2 ëª…ì„¸
    spec_file: str  # Domains/[project].idr
    compile_attempts: int
    compile_success: bool
    compile_errors: List[str]

    # ========== Phase 3: ë¬¸ì„œ êµ¬í˜„ ==========
    documentable_impl: Optional[str]  # DomainToDoc êµ¬í˜„
    pipeline_impl: Optional[str]      # Generator íŒŒì´í”„ë¼ì¸

    # ========== Phase 4: ì´ˆì•ˆ ìƒì„± ==========
    draft_txt: Optional[str]
    draft_md: Optional[str]
    draft_csv: Optional[Dict[str, str]]  # í‘œ ë°ì´í„°

    # ========== Phase 5: ë°˜ë³µ ê°œì„  ==========
    version: int  # ë²„ì „ ë²ˆí˜¸ (v1, v2, ...)
    user_feedback: List[str]  # ì‚¬ìš©ì í”¼ë“œë°± íˆìŠ¤í† ë¦¬
    current_feedback: Optional[str]
    satisfied: bool  # ì‚¬ìš©ì ë§Œì¡± ì—¬ë¶€

    # ========== Phase 6: ìµœì¢… ì¶œë ¥ ==========
    generate_pdf: bool
    final_pdf_path: Optional[str]

    # ========== ë©”íƒ€ ==========
    messages: List[str]
    current_phase: str  # "spec", "draft", "feedback", "final"
```

---

## LangGraph Workflow (ê°œì •íŒ)

```python
workflow = StateGraph(DocumentGenerationState)

# ========== Phase 1: ëª…ì„¸ ìƒì„± ==========
workflow.add_node("parse_input", parse_user_input)
workflow.add_node("analyze_docs", analyze_documents)
workflow.add_node("generate_spec", generate_idris_spec)
workflow.add_node("typecheck_spec", typecheck_idris)
workflow.add_node("fix_spec_error", fix_spec_errors)

# ========== Phase 2: ë¬¸ì„œ êµ¬í˜„ ==========
workflow.add_node("generate_documentable", generate_documentable_impl)
workflow.add_node("generate_pipeline", generate_pipeline_impl)

# ========== Phase 3: ì´ˆì•ˆ ìƒì„± ==========
workflow.add_node("generate_txt", generate_text_output)
workflow.add_node("generate_csv", generate_csv_output)
workflow.add_node("generate_md", generate_markdown_output)

# ========== Phase 4: ì‚¬ìš©ì í”¼ë“œë°± ==========
workflow.add_node("present_draft", present_to_user)  # ğŸ”´ HUMAN INPUT
workflow.add_node("collect_feedback", collect_user_feedback)  # ğŸ”´ HUMAN INPUT

# ========== Phase 5: ë°˜ë³µ ê°œì„  ==========
workflow.add_node("parse_feedback", parse_user_feedback)
workflow.add_node("update_spec", update_idris_spec)
workflow.add_node("recompile", recompile_spec)

# ========== Phase 6: ìµœì¢… ì¶œë ¥ ==========
workflow.add_node("generate_pdf", generate_pdf_output)
workflow.add_node("finalize", finalize_project)

# ========== ì—£ì§€ ==========
workflow.add_edge("parse_input", "analyze_docs")
workflow.add_edge("analyze_docs", "generate_spec")
workflow.add_edge("generate_spec", "typecheck_spec")

# ì»´íŒŒì¼ ë£¨í”„
workflow.add_conditional_edges(
    "typecheck_spec",
    lambda s: "success" if s["compile_success"] else "fix",
    {"success": "generate_documentable", "fix": "fix_spec_error"}
)
workflow.add_edge("fix_spec_error", "typecheck_spec")

# ë¬¸ì„œ êµ¬í˜„
workflow.add_edge("generate_documentable", "generate_pipeline")
workflow.add_edge("generate_pipeline", "generate_txt")
workflow.add_edge("generate_txt", "generate_csv")
workflow.add_edge("generate_csv", "generate_md")

# ğŸ”´ ì‚¬ìš©ì í”¼ë“œë°± ë£¨í”„ (ì¤‘ìš”!)
workflow.add_edge("generate_md", "present_draft")

workflow.add_conditional_edges(
    "collect_feedback",
    lambda s: "satisfied" if s["satisfied"] else "revise",
    {
        "satisfied": "check_pdf_request",
        "revise": "parse_feedback"
    }
)

# ìˆ˜ì • ë£¨í”„
workflow.add_edge("parse_feedback", "update_spec")
workflow.add_edge("update_spec", "recompile")
workflow.add_edge("recompile", "generate_txt")  # ì´ˆì•ˆ ì¬ìƒì„±

# PDF ìƒì„± (ì„ íƒ)
workflow.add_conditional_edges(
    "check_pdf_request",
    lambda s: "yes" if s["generate_pdf"] else "done",
    {"yes": "generate_pdf", "done": "finalize"}
)

workflow.add_edge("generate_pdf", "finalize")
workflow.add_edge("finalize", END)

workflow.set_entry_point("parse_input")
```

---

## í•µì‹¬ ì°¨ì´ì 

| í•­ëª© | ê¸°ì¡´ ë°©ì‹ | ìƒˆ ë°©ì‹ |
|------|-----------|---------|
| ì¶œë ¥ | PDF ë°”ë¡œ ìƒì„± | txt/csv/md ë¨¼ì € â†’ ê²€í†  â†’ PDF |
| í”¼ë“œë°± | ì—†ìŒ | ë°˜ë³µì  ìˆ˜ì • ë£¨í”„ |
| ë²„ì „ ê´€ë¦¬ | 1íšŒ ìƒì„± | v1, v2, ... ì¶”ì  |
| ì‚¬ìš©ì ì°¸ì—¬ | ì‹œì‘ê³¼ ëë§Œ | ì´ˆì•ˆ ê²€í† , ìˆ˜ì • ìš”ì²­ |
| ëª…ì„¸ ìˆ˜ì • | ë¶ˆê°€ | ìë™ ìˆ˜ì • & ì¬ì»´íŒŒì¼ |

---

## ì‚¬ìš© ì˜ˆì‹œ

```python
# ì‹œì‘
state = {
    "project_name": "SpiratiContract",
    "user_prompt": "ìŠ¤í”¼ë¼í‹°ì™€ ì´ì¸ ì—ë“€ ê°„ ìˆ˜í•™ë¬¸í•­ ì…ë ¥ ìš©ì—­ê³„ì•½ì„œ...",
    "reference_docs": ["direction/ì™¸ì£¼ìš©ì—­.pdf"],
    ...
}

app = create_workflow()

# Phase 1-3: ìë™ ì‹¤í–‰
result = app.invoke(state)

# Phase 4: ì‚¬ìš©ìì—ê²Œ ì´ˆì•ˆ ì œì‹œ
print(f"ì´ˆì•ˆ: {result['draft_txt']}")

# ğŸ”´ ì‚¬ìš©ì í”¼ë“œë°± ëŒ€ê¸°
user_input = input("ìˆ˜ì • ì‚¬í•­ì´ ìˆë‚˜ìš”? (ì—†ìœ¼ë©´ 'ì™„ë£Œ'): ")

if user_input != "ì™„ë£Œ":
    # Phase 5: ìˆ˜ì • ë£¨í”„
    result["current_feedback"] = user_input
    result["satisfied"] = False
    result = app.invoke(result)  # ì¬ì‹¤í–‰
else:
    result["satisfied"] = True

# Phase 6: PDF ìƒì„± ì—¬ë¶€
pdf_request = input("PDFë¥¼ ìƒì„±í• ê¹Œìš”? (y/n): ")
result["generate_pdf"] = (pdf_request == "y")

# ìµœì¢… ì‹¤í–‰
final = app.invoke(result)

print(f"âœ… ì™„ë£Œ: {final['final_pdf_path']}")
```

---

## ë‹¤ìŒ ë‹¨ê³„

1. **Lightweight Renderer êµ¬í˜„**
   - TextRenderer (LaTeX ëŒ€ì‹  ìˆœìˆ˜ í…ìŠ¤íŠ¸)
   - CSVRenderer (í‘œ ë°ì´í„° ì¶”ì¶œ)
   - MarkdownRenderer

2. **Feedback Parser**
   - ìì—°ì–´ â†’ ëª…ì„¸ ë³€ê²½ì‚¬í•­ ë§¤í•‘
   - "ì„ ê¸‰ê¸ˆ 30%ë¡œ" â†’ `advance = total * 0.3`

3. **Version Management**
   - v1, v2, ... ìë™ ì¶”ì 
   - diff ìƒì„±

4. **Human-in-the-loop UI**
   - ì›¹ ì¸í„°í˜ì´ìŠ¤ ë˜ëŠ” CLI
